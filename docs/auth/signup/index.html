<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Create Your Galactly Account</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      /* Professional Light Color System */
      --bg-primary: #FAFAFA;
      --bg-secondary: #FFFFFF;
      --bg-elevated: #FFFFFF;
      --surface: rgba(255, 255, 255, 0.8);
      --surface-hover: rgba(255, 255, 255, 0.95);
      --border: rgba(0, 0, 0, 0.08);
      --border-focus: rgba(59, 130, 246, 0.4);
      
      --text-primary: #0F172A;
      --text-secondary: #475569;
      --text-muted: #94A3B8;
      
      --accent-primary: #3B82F6;
      --accent-hover: #2563EB;
      --accent-subtle: rgba(59, 130, 246, 0.08);
      
      --success: #22C55E;
      --error: #EF4444;
      --warning: #F59E0B;
      
      --spacing-xs: 0.25rem;
      --spacing-sm: 0.5rem;
      --spacing-md: 1rem;
      --spacing-lg: 1.5rem;
      --spacing-xl: 2rem;
      --spacing-2xl: 3rem;
      
      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
      
      --duration-fast: 150ms;
      --duration-normal: 250ms;
      --duration-slow: 350ms;
      
      --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: radial-gradient(circle at top, #EFF6FF 0, #FAFAFA 55%, #F1F5F9 100%);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--spacing-md);
      line-height: 1.6;
    }

    .page-shell {
      width: 100%;
      max-width: 960px;
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      gap: var(--spacing-2xl);
      align-items: center;
    }

    .brand-column {
      padding: var(--spacing-xl);
    }

    .logo-row {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-xl);
    }

    .logo-mark {
      width: 36px;
      height: 36px;
      border-radius: 999px;
      background: linear-gradient(135deg, #3B82F6, #1D4ED8);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 1.1rem;
      box-shadow: 0 10px 30px rgba(37, 99, 235, 0.35);
    }

    .logo-text {
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: -0.04em;
      color: var(--text-primary);
    }

    .hero-heading {
      font-size: 2.25rem;
      font-weight: 600;
      letter-spacing: -0.04em;
      margin-bottom: var(--spacing-md);
      color: var(--text-primary);
    }

    .hero-subtitle {
      font-size: 1.05rem;
      color: var(--text-secondary);
      max-width: 26rem;
    }

    .hero-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.35rem 0.8rem;
      border-radius: 999px;
      background: rgba(34, 197, 94, 0.06);
      color: #15803D;
      font-size: 0.78rem;
      font-weight: 500;
      margin-bottom: 0.75rem;
    }

    .form-card {
      background: var(--bg-secondary);
      backdrop-filter: blur(18px);
      border-radius: var(--radius-xl);
      padding: var(--spacing-xl);
      box-shadow:
        0 22px 45px rgba(15, 23, 42, 0.16),
        0 0 0 1px rgba(148, 163, 184, 0.12);
      border: 1px solid var(--border);
      max-width: 420px;
      margin-left: auto;
    }

    .form-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--spacing-lg);
    }

    .form-title {
      font-size: 1.35rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .form-subtitle {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-top: 0.15rem;
    }

    .back-link {
      font-size: 0.85rem;
      color: var(--text-muted);
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.35rem 0.6rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(248, 250, 252, 0.85);
      backdrop-filter: blur(12px);
      transition: all 150ms var(--ease-smooth);
    }

    .back-link:hover {
      border-color: rgba(148, 163, 184, 0.7);
      background: white;
      transform: translateY(-1px);
    }

    .oauth-button {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(248, 250, 252, 0.9);
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 500;
      color: var(--text-primary);
      transition: all var(--duration-fast) var(--ease-smooth);
    }

    .oauth-button:hover {
      background: white;
      box-shadow: 0 6px 18px rgba(148, 163, 184, 0.25);
      transform: translateY(-1px);
    }

    .oauth-icon {
      width: 18px;
      height: 18px;
      border-radius: 4px;
      background: conic-gradient(from 180deg at 50% 50%, #4285F4 0deg, #34A853 90deg, #FBBC05 180deg, #EA4335 270deg, #4285F4 360deg);
    }

    .divider {
      display: flex;
      align-items: center;
      margin: var(--spacing-lg) 0;
      gap: var(--spacing-md);
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .divider-line {
      flex: 1;
      height: 1px;
      background: linear-gradient(to right, transparent, rgba(148, 163, 184, 0.6), transparent);
    }

    .field-group {
      margin-bottom: var(--spacing-md);
    }

    .field-label {
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 0.35rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .field-label small {
      font-weight: 400;
      color: var(--text-muted);
    }

    .input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
      background: var(--bg-secondary);
      backdrop-filter: blur(12px);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 0 var(--spacing-md);
      transition: all var(--duration-fast) var(--ease-smooth);
      box-shadow: 0 1px 2px rgba(15, 23, 42, 0.08);
    }

    .input-wrapper:focus-within {
      background: var(--bg-elevated);
      border-color: var(--accent-primary);
      box-shadow:
        0 0 0 1px rgba(59, 130, 246, 0.18),
        0 0 0 6px rgba(59, 130, 246, 0.08),
        0 8px 22px rgba(15, 23, 42, 0.12);
    }

    .input-icon {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-right: 0.5rem;
    }

    .input-field {
      width: 100%;
      padding: 0.7rem 0;
      border: none;
      outline: none;
      background: transparent;
      font-size: 0.95rem;
      color: var(--text-primary);
      font-family: inherit;
    }

    .input-field::placeholder {
      color: var(--text-muted);
    }

    .strength-bar {
      display: flex;
      gap: 4px;
      margin-top: 6px;
    }

    .strength-bar span {
      flex: 1;
      height: 4px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.35);
      transition: background 160ms ease;
    }

    .strength-label {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .helper-text {
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .error-text {
      font-size: 0.78rem;
      color: var(--error);
      margin-top: 4px;
    }

    .btn-primary {
      width: 100%;
      padding: 0.8rem 1rem;
      border-radius: var(--radius-md);
      border: none;
      background: linear-gradient(135deg, #3B82F6, #2563EB);
      color: white;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.45rem;
      box-shadow:
        0 12px 30px rgba(37, 99, 235, 0.55),
        0 1px 0 rgba(255, 255, 255, 0.2);
      transition: all var(--duration-fast) var(--ease-smooth);
      margin-top: var(--spacing-sm);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow:
        0 18px 45px rgba(37, 99, 235, 0.65),
        0 2px 0 rgba(255, 255, 255, 0.25);
    }

    .btn-primary:disabled {
      opacity: 0.7;
      cursor: default;
      transform: none;
      box-shadow:
        0 6px 18px rgba(148, 163, 184, 0.4),
        0 1px 0 rgba(255, 255, 255, 0.15);
    }

    .btn-text {
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
    }

    .loading {
      width: 14px;
      height: 14px;
      border-radius: 999px;
      border: 2px solid rgba(248, 250, 252, 0.6);
      border-top-color: white;
      animation: spin 0.7s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .footer-text {
      margin-top: var(--spacing-md);
      font-size: 0.85rem;
      color: var(--text-muted);
      text-align: center;
    }

    .footer-text a {
      color: var(--accent-primary);
      text-decoration: none;
      font-weight: 500;
    }

    .footer-text a:hover {
      text-decoration: underline;
    }

    .alert {
      border-radius: var(--radius-md);
      padding: 0.75rem 0.85rem;
      font-size: 0.85rem;
      margin-bottom: var(--spacing-md);
      display: none;
    }

    .alert-error {
      background: rgba(248, 113, 113, 0.09);
      border: 1px solid rgba(248, 113, 113, 0.8);
      color: #B91C1C;
    }

    .alert-success {
      background: rgba(34, 197, 94, 0.08);
      border: 1px solid rgba(34, 197, 94, 0.7);
      color: #166534;
    }

    .rejection-extra {
      margin-top: var(--spacing-md);
      display: none;
      text-align: center;
    }

    .founder-btn {
      margin-top: 0.5rem;
      padding: 0.6rem 1rem;
      border-radius: 999px;
      border: none;
      background: #0F172A;
      color: white;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      transition: all 160ms ease;
    }

    .founder-btn:hover {
      background: #020617;
      transform: translateY(-1px);
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.5);
    }

    @media (max-width: 900px) {
      .page-shell {
        grid-template-columns: minmax(0, 1fr);
        max-width: 480px;
      }

      .brand-column {
        order: -1;
        padding-bottom: 0;
        text-align: center;
      }

      .hero-subtitle {
        margin-left: auto;
        margin-right: auto;
      }

      .form-card {
        margin-left: 0;
      }

      body {
        padding-top: 2.5rem;
        padding-bottom: 2.5rem;
      }

      .form-header {
        flex-direction: row-reverse;
        justify-content: space-between;
      }
    }
  </style>
</head>
<body>
  <div class="page-shell">
    <div class="brand-column">
      <div class="logo-row">
        <div class="logo-mark">G</div>
        <div class="logo-text">Galactly</div>
      </div>
      <div class="hero-pill">
        <span>‚úì AI-validated packaging suppliers</span>
      </div>
      <h1 class="hero-heading">Create your account</h1>
      <p class="hero-subtitle">Join the packaging supply network. We‚Äôll verify your company and unlock tailored market intelligence.</p>
    </div>

    <div class="form-card">
      <div class="form-header">
        <div>
          <div class="form-title">Sign up</div>
          <div class="form-subtitle">Use your work email to get started.</div>
        </div>
        <a href="/docs/auth/" class="back-link" id="backLink">
          <span>‚Üê</span>
          <span>Back</span>
        </a>
      </div>

      <div id="alert" class="alert alert-error"></div>

      <button type="button" class="oauth-button" id="googleBtn">
        <span class="oauth-icon" aria-hidden="true"></span>
        <span>Continue with Google</span>
      </button>

      <div class="divider">
        <div class="divider-line"></div>
        <span>or</span>
        <div class="divider-line"></div>
      </div>

      <form id="signupForm" novalidate>
        <div class="field-group">
          <label class="field-label" for="email">
            <span>Work email</span>
          </label>
          <div class="input-wrapper">
            <span class="input-icon">üìß</span>
            <input
              type="email"
              id="email"
              name="email"
              class="input-field"
              placeholder="you@company.com"
              autocomplete="email"
              required
            />
          </div>
          <div id="emailError" class="error-text" style="display:none"></div>
        </div>

        <div class="field-group">
          <label class="field-label" for="password">
            <span>Password</span>
            <small>Min 8 characters</small>
          </label>
          <div class="input-wrapper">
            <span class="input-icon">üîí</span>
            <input
              type="password"
              id="password"
              name="password"
              class="input-field"
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              autocomplete="new-password"
              required
            />
          </div>
          <div class="strength-bar" id="strengthBar">
            <span></span><span></span><span></span>
          </div>
          <div class="strength-label" id="strengthLabel">Password strength: Weak</div>
          <div id="passwordError" class="error-text" style="display:none"></div>
        </div>

        <div class="field-group">
          <label class="field-label" for="companyName">
            <span>Company name</span>
          </label>
          <div class="input-wrapper">
            <span class="input-icon">üè¢</span>
            <input
              type="text"
              id="companyName"
              name="companyName"
              class="input-field"
              placeholder="Acme Packaging"
              autocomplete="organization"
              required
            />
          </div>
          <div id="companyError" class="error-text" style="display:none"></div>
        </div>

        <div class="field-group">
          <label class="field-label" for="website">
            <span>Company website</span>
          </label>
          <div class="input-wrapper">
            <span class="input-icon">üåê</span>
            <input
              type="url"
              id="website"
              name="website"
              class="input-field"
              placeholder="https://example.com"
              autocomplete="url"
              required
            />
          </div>
          <div class="helper-text">We‚Äôll use this to verify that you‚Äôre a physical packaging business.</div>
          <div id="websiteError" class="error-text" style="display:none"></div>
        </div>

        <button type="submit" class="btn-primary" id="submitBtn">
          <span class="btn-text" id="submitBtnText">Create account</span>
        </button>
      </form>

      <div id="rejectionBlock" class="rejection-extra">
        <p class="helper-text" id="rejectionMessage"></p>
        <button type="button" class="founder-btn" id="founderBtn">
          <span>Talk to the founder</span>
          <span>‚Üó</span>
        </button>
      </div>

      <p class="footer-text">
        Already have an account?
        <a href="/docs/auth/login/">Sign in</a>
      </p>
    </div>
  </div>

  <script>
    const personalDomains = [
      'gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com',
      'aol.com', 'icloud.com', 'protonmail.com'
    ];

    function validateEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      const domain = email.split('@')[1]?.toLowerCase();
      return re.test(email) && !personalDomains.includes(domain);
    }

    function validatePassword(password) {
      return password.length >= 8;
    }

    function validateWebsite(url) {
      try {
        const urlObj = new URL(url);
        return urlObj.protocol === 'http:' || urlObj.protocol === 'https:';
      } catch {
        return false;
      }
    }

    function updatePasswordStrength(password) {
      const bar = document.getElementById('strengthBar');
      const label = document.getElementById('strengthLabel');
      const segments = bar.querySelectorAll('span');

      let score = 0;
      if (password.length >= 8) score++;
      if (/[A-Z]/.test(password)) score++;
      if (/\d|[^A-Za-z0-9]/.test(password)) score++;

      segments.forEach((seg, index) => {
        if (index < score) {
          seg.style.background = index === 0 ? '#F97316' : index === 1 ? '#EAB308' : '#22C55E';
        } else {
          seg.style.background = 'rgba(148, 163, 184, 0.35)';
        }
      });

      if (score === 0) {
        label.textContent = 'Password strength: Weak';
      } else if (score === 1) {
        label.textContent = 'Password strength: Weak';
      } else if (score === 2) {
        label.textContent = 'Password strength: Medium';
      } else {
        label.textContent = 'Password strength: Strong';
      }
    }

    function showAlert(message, type) {
      const alertEl = document.getElementById('alert');
      alertEl.textContent = message;
      alertEl.style.display = 'block';
      alertEl.className = 'alert ' + (type === 'error' ? 'alert-error' : 'alert-success');
    }

    function hideAlert() {
      const alertEl = document.getElementById('alert');
      alertEl.style.display = 'none';
    }

    function showFounderContactButton() {
      const block = document.getElementById('rejectionBlock');
      block.style.display = 'block';
    }

    document.getElementById('founderBtn').addEventListener('click', () => {
      window.open('https://calendly.com/founder', '_blank');
    });

    document.getElementById('backLink').addEventListener('click', (e) => {
      e.preventDefault();
      window.location.href = '/docs/auth/';
    });

    const passwordInput = document.getElementById('password');
    passwordInput.addEventListener('input', (e) => {
      updatePasswordStrength(e.target.value);
    });

    const signupForm = document.getElementById('signupForm');
    signupForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      hideAlert();

      const emailInput = document.getElementById('email');
      const passwordInput = document.getElementById('password');
      const companyInput = document.getElementById('companyName');
      const websiteInput = document.getElementById('website');

      const email = emailInput.value.trim();
      const password = passwordInput.value;
      const companyName = companyInput.value.trim();
      const website = websiteInput.value.trim();

      let valid = true;

      const emailError = document.getElementById('emailError');
      const passwordError = document.getElementById('passwordError');
      const companyError = document.getElementById('companyError');
      const websiteError = document.getElementById('websiteError');

      emailError.style.display = 'none';
      passwordError.style.display = 'none';
      companyError.style.display = 'none';
      websiteError.style.display = 'none';

      if (!validateEmail(email)) {
        emailError.textContent = 'Please use a valid work email (no personal domains).';
        emailError.style.display = 'block';
        valid = false;
      }

      if (!validatePassword(password)) {
        passwordError.textContent = 'Password must be at least 8 characters long.';
        passwordError.style.display = 'block';
        valid = false;
      }

      if (!companyName) {
        companyError.textContent = 'Company name is required.';
        companyError.style.display = 'block';
        valid = false;
      }

      if (!validateWebsite(website)) {
        websiteError.textContent = 'Please enter a valid URL starting with http:// or https://.';
        websiteError.style.display = 'block';
        valid = false;
      }

      if (!valid) return;

      const submitBtn = document.getElementById('submitBtn');
      const submitBtnText = document.getElementById('submitBtnText');

      submitBtn.disabled = true;
      submitBtnText.innerHTML = '<span class="loading"></span><span>Creating account...</span>';

      try {
        const response = await fetch('/api/auth/signup', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            email,
            password,
            companyName,
            website
          })
        });

        const data = await response.json().catch(() => ({}));

        if (response.ok && data.status === 'approved') {
          localStorage.setItem('galactly_temp_token', data.tempToken);
          localStorage.setItem('galactly_company_data', JSON.stringify(data.companyData));
          window.location.href = '/docs/auth/verified/';
        } else if (data.status === 'rejected') {
          const message = data.reason || "At this moment, we can only help physical packaging businesses and it appears that you're not. Please try again or contact us.";
          document.getElementById('rejectionMessage').textContent = message;
          showAlert(message, 'error');
          showFounderContactButton();
        } else {
          showAlert('Something went wrong. Please try again.', 'error');
        }
      } catch (error) {
        console.error('Signup error:', error);
        showAlert('Network error. Please check your connection.', 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtnText.textContent = 'Create account';
      }
    });

    document.getElementById('googleBtn').addEventListener('click', () => {
      const redirectUri = window.location.origin + '/auth/callback';
      const oauthUrl = `/api/auth/google/authorize?redirect_uri=${encodeURIComponent(redirectUri)}`;
      window.location.href = oauthUrl;
    });
  </script>
</body>
</html>
